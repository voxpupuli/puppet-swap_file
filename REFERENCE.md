# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Classes

* [`swap_file`](#swap_file): Main class to allow passing required swapfiles as hashes
* [`swap_file::swappiness`](#swap_file--swappiness): Allows setting the kernel swappiness setting

### Defined types

* [`swap_file::files`](#swap_file--files): Define: swap_file::files  This is a defined type to create a swap_file  == Parameters [*ensure*]   Allows creation or removal of swapspace an
* [`swap_file::resize`](#swap_file--resize): A defined type to resize an existing swapfile

### Resource types

* [`swap_file`](#swap_file): Used to configure swap files === Examples  swap_file { '/mnt/swap.1':   ensure   => 'present',   size     => '1068028', }

### Functions

* [`difference_within_margin`](#difference_within_margin): Get's the difference between two numbers, with a third argument as a margin  *Example:*      compare_with_margin(100,150,60)  Would result in
* [`swap_file_size_from_csv`](#swap_file_size_from_csv): Given a csv of swap files and sizes, split by pipe (||), we can determine the size in bytes of the swapfile Will return false if the swapfile

## Classes

### <a name="swap_file"></a>`swap_file`

Main class to allow passing required swapfiles as hashes

#### Examples

##### Will create one swapfile in /mnt/swap using the defaults.

```puppet
class { '::swap_file':
  'files' => {
    'resource_name' => {
      ensure   => present,
      swapfile => '/mnt/swap',
    },
  },
}
```

##### Will create two swapfile with the given parameters

```puppet
class { 'swap_file':
  'files' => {
    'swap1' => {
      ensure       => present,
      swapfile     => '/mnt/swap.1',
      swapfilesize => '1 GB',
    },
    'swap2' => {
      ensure       => present,
      swapfile     => '/mnt/swap.2',
      swapfilesize => '2 GB',
      cmd          => 'fallocate',
    },
  },
}
```

##### Will merge all found instances of swap_file::files found in hiera and create resources for these.

```puppet
class { '::swap_file':
  files_hiera_merge: true,
}
```

#### Parameters

The following parameters are available in the `swap_file` class:

* [`files`](#-swap_file--files)
* [`files_hiera_merge`](#-swap_file--files_hiera_merge)

##### <a name="-swap_file--files"></a>`files`

Data type: `Hash`

Hash of swap files to ensure with swap_file::files

Default value: `{}`

##### <a name="-swap_file--files_hiera_merge"></a>`files_hiera_merge`

Data type: `Variant[Boolean,Enum['true','false']]`

Boolean to merge all found instances of swap_file::files in Hiera.
This can be used to specify swap files at different levels an have
them all included in the catalog.

Default value: `false`

### <a name="swap_file--swappiness"></a>`swap_file::swappiness`

Allows setting the kernel swappiness setting

#### Examples

##### Will set the sysctl setting for swappiness to 75

```puppet
class { '::swap_file::swappiness':
  swappiness => 75,
}
```

#### Parameters

The following parameters are available in the `swap_file::swappiness` class:

* [`swapiness`](#-swap_file--swappiness--swapiness)
* [`swappiness`](#-swap_file--swappiness--swappiness)

##### <a name="-swap_file--swappiness--swapiness"></a>`swapiness`

Data type: `String`

Swapiness level, integer from 0 - 100 inclusive

##### <a name="-swap_file--swappiness--swappiness"></a>`swappiness`

Data type: `Integer[0,100]`



Default value: `60`

## Defined types

### <a name="swap_file--files"></a>`swap_file::files`

Define: swap_file::files

This is a defined type to create a swap_file

== Parameters
[*ensure*]
  Allows creation or removal of swapspace and the corresponding file.
[*swapfile*]
  Location of swapfile, defaults to /mnt
[*swapfilesize*]
  Size of the swapfile as a string (eg. 10 MB, 1.2 GB).
  Defaults to $::memorysize fact on the node
[*add_mount*]
  Add a mount to the swapfile so it persists on boot
[*options*]
  Mount options for the swapfile
[*timeout*]
  dd command exec timeout.
  Defaults to 300
[*cmd*]
  What command is used to create the file, dd or fallocate. dd is better tested and safer but fallocate is significantly faster.
  Defaults to dd

== Examples

  swap_file::files { 'default':
    ensure   => present,
    swapfile => '/mnt/swap.55',
  }

== Authors
   @petems - Peter Souter

#### Parameters

The following parameters are available in the `swap_file::files` defined type:

* [`ensure`](#-swap_file--files--ensure)
* [`swapfile`](#-swap_file--files--swapfile)
* [`swapfilesize`](#-swap_file--files--swapfilesize)
* [`add_mount`](#-swap_file--files--add_mount)
* [`options`](#-swap_file--files--options)
* [`timeout`](#-swap_file--files--timeout)
* [`cmd`](#-swap_file--files--cmd)
* [`resize_existing`](#-swap_file--files--resize_existing)
* [`resize_margin`](#-swap_file--files--resize_margin)
* [`resize_verbose`](#-swap_file--files--resize_verbose)

##### <a name="-swap_file--files--ensure"></a>`ensure`

Data type: `Enum['absent','present']`



Default value: `'present'`

##### <a name="-swap_file--files--swapfile"></a>`swapfile`

Data type: `Stdlib::Unixpath`



Default value: `'/mnt/swap.1'`

##### <a name="-swap_file--files--swapfilesize"></a>`swapfilesize`

Data type: `Any`



Default value: `$facts['memory']['system']['total']`

##### <a name="-swap_file--files--add_mount"></a>`add_mount`

Data type: `Boolean`



Default value: `true`

##### <a name="-swap_file--files--options"></a>`options`

Data type: `Any`



Default value: `'defaults'`

##### <a name="-swap_file--files--timeout"></a>`timeout`

Data type: `Any`



Default value: `300`

##### <a name="-swap_file--files--cmd"></a>`cmd`

Data type: `Any`



Default value: `'dd'`

##### <a name="-swap_file--files--resize_existing"></a>`resize_existing`

Data type: `Any`



Default value: `false`

##### <a name="-swap_file--files--resize_margin"></a>`resize_margin`

Data type: `Any`



Default value: `'50MB'`

##### <a name="-swap_file--files--resize_verbose"></a>`resize_verbose`

Data type: `Any`



Default value: `false`

### <a name="swap_file--resize"></a>`swap_file::resize`

A defined type to resize an existing swapfile

#### Examples

##### 

```puppet
::swap_file::resize { '/mnt/swap.1:
  swapfile_path          => '/mnt/swap.1',
  margin                 => '500 MB',
  expected_swapfile_size => '1 GB,
}
```

#### Parameters

The following parameters are available in the `swap_file::resize` defined type:

* [`swapfile_path`](#-swap_file--resize--swapfile_path)
* [`expected_swapfile_size`](#-swap_file--resize--expected_swapfile_size)
* [`actual_swapfile_size`](#-swap_file--resize--actual_swapfile_size)
* [`margin`](#-swap_file--resize--margin)
* [`verbose`](#-swap_file--resize--verbose)

##### <a name="-swap_file--resize--swapfile_path"></a>`swapfile_path`

Data type: `String`

Path to the swapfile

##### <a name="-swap_file--resize--expected_swapfile_size"></a>`expected_swapfile_size`

Data type: `String`

Expected size of the swapfile

##### <a name="-swap_file--resize--actual_swapfile_size"></a>`actual_swapfile_size`

Data type: `String`

Actual size of the swapfile

##### <a name="-swap_file--resize--margin"></a>`margin`

Data type: `String`

Margin that is checked before resizing the swapfile

Default value: `'50MB'`

##### <a name="-swap_file--resize--verbose"></a>`verbose`

Data type: `Boolean`

Adds a notify to explain why the change was made

Default value: `false`

## Resource types

### <a name="swap_file"></a>`swap_file`

Used to configure swap files
=== Examples

swap_file { '/mnt/swap.1':
  ensure   => 'present',
  size     => '1068028',
}

#### Properties

The following properties are available in the `swap_file` type.

##### `ensure`

Valid values: `present`, `absent`

The basic property that the resource should be in.

Default value: `present`

##### `priority`

The priority of the swapfile

##### `size`

The size of the swapfile in bytes

##### `type`

The type of the swapfile

##### `used`

The amount of space used

#### Parameters

The following parameters are available in the `swap_file` type.

* [`file`](#-swap_file--file)
* [`provider`](#-swap_file--provider)

##### <a name="-swap_file--file"></a>`file`

The file path of the swapfile.

##### <a name="-swap_file--provider"></a>`provider`

The specific backend to use for this `swap_file` resource. You will seldom need to specify this --- Puppet will usually
discover the appropriate provider for your platform.

## Functions

### <a name="difference_within_margin"></a>`difference_within_margin`

Type: Ruby 3.x API

Get's the difference between two numbers, with a third argument as a margin

*Example:*

    compare_with_margin(100,150,60)

Would result in:

    true

    compare_with_margin(100,150,40)

Would result in:

    false

#### `difference_within_margin()`

Get's the difference between two numbers, with a third argument as a margin

*Example:*

    compare_with_margin(100,150,60)

Would result in:

    true

    compare_with_margin(100,150,40)

Would result in:

    false

Returns: `Any`

### <a name="swap_file_size_from_csv"></a>`swap_file_size_from_csv`

Type: Ruby 3.x API

Given a csv of swap files and sizes, split by pipe (||), we can determine the size in bytes of the swapfile
Will return false if the swapfile is not found in the csv
*Examples:*
    get_swap_file_size_from_csv('/mnt/swap.1','/mnt/swap.1||1019900,/mnt/swap.1||1019900')
Would return: 1019900
    get_swap_file_size_from_csv('/mnt/swap.2','/mnt/swap.1||1019900,/mnt/swap.1||1019900')
Would return: false

#### `swap_file_size_from_csv()`

Given a csv of swap files and sizes, split by pipe (||), we can determine the size in bytes of the swapfile
Will return false if the swapfile is not found in the csv
*Examples:*
    get_swap_file_size_from_csv('/mnt/swap.1','/mnt/swap.1||1019900,/mnt/swap.1||1019900')
Would return: 1019900
    get_swap_file_size_from_csv('/mnt/swap.2','/mnt/swap.1||1019900,/mnt/swap.1||1019900')
Would return: false

Returns: `Any`

